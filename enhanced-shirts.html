<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Shirts - RAW FADE</title>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
	<style>
		* { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
		html { overflow-x: hidden; }
		:root {
			--bg: #000000;
			--panel: #111111;
			--text: #ffffff;
			--muted: #cccccc;
			--accent: #ffffff;
			--border: #333333;
		}
		body { background: #000000; color: #ffffff; overflow-x: hidden; }

		/* Enhanced Header */
		#header { 
			background: linear-gradient(135deg, rgba(0, 0, 0, 0.95), rgba(0, 0, 0, 0.95), rgba(9, 9, 11, 0.95));
			backdrop-filter: blur(15px);
			-webkit-backdrop-filter: blur(15px);
			border-bottom: 2px solid rgba(66, 65, 65, 0.2); 
			box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
			position: sticky; 
			top: 0; 
			z-index: 999; 
			padding: 0 32px;
			display: flex;
			align-items: center;
			justify-content: center;
			height: 80px;
			overflow: hidden;
			animation: headerGlow 4s ease-in-out infinite alternate;
		}

		@keyframes headerGlow {
			0% {
				box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3), 0 0 30px rgba(135, 206, 235, 0.1);
			}
			100% {
				box-shadow: 0 4px 25px rgba(0, 0, 0, 0.4), 0 0 40px rgba(135, 206, 235, 0.2);
			}
		}

		.logo-container {
			flex: 0 0 auto;
			margin-right: 15px;
			display: flex;
			align-items: center;
			padding: 0;
			height: 100%;
			overflow: hidden;
			animation: logoFloat 3s ease-in-out infinite;
		}

		@keyframes logoFloat {
			0%, 100% { transform: translateY(0px); }
			50% { transform: translateY(-2px); }
		}

		.logo-container img {
			height: 100%;
			width: auto;
			max-height: 150px;
			display: block;
			margin: 0;
			padding: 0;
			transform: none;
			filter: drop-shadow(0 2px 8px rgba(255, 255, 255, 0.3));
			transition: all 0.3s ease;
		}

		.logo-container img:hover {
			filter: drop-shadow(0 4px 12px rgba(255, 255, 255, 0.5));
			transform: scale(1.05);
		}

		#header nav {
			flex: 1;
			display: flex;
			justify-content: center;
		}

		#navbar { 
			display: flex; 
			align-items: center; 
			justify-content: center; 
			flex-wrap: wrap; 
			gap: 12px; 
			margin: 0; 
			padding: 0;
			animation: navSlideIn 1s ease-out;
		}

		@keyframes navSlideIn {
			0% {
				opacity: 0;
				transform: translateY(-20px);
			}
			100% {
				opacity: 1;
				transform: translateY(0);
			}
		}

		#navbar li { 
			list-style: none; 
			margin: 0 8px; 
		}
		
		#navbar li a { 
			color: var(--text); 
			text-decoration: none; 
			font-weight: 600; 
			padding: 8px 16px; 
			border-radius: 20px; 
			transition: all 0.3s ease; 
			position: relative; 
			overflow: hidden; 
			min-width: 100px; 
			text-align: center; 
			display: block;
		}
		
		#navbar li a:hover { 
			background: rgba(255,255,255,0.1); 
			transform: translateY(-2px); 
		}
		
		#navbar li a::after { 
			content: ''; 
			position: absolute; 
			bottom: 0; 
			left: 50%; 
			width: 0; 
			height: 2px; 
			background: var(--accent); 
			transition: all 0.3s ease; 
			transform: translateX(-50%); 
		}
		
		#navbar li a:hover::after { 
			width: 70%; 
		}

		/* Page Header */
		.page-header { 
			padding: 40px 24px; 
			text-align: center; 
			background: linear-gradient(135deg, #1a1a2e 0%, #16213e 30%, #041325 60%, #1a1a2e 100%);
			border-bottom: 1px solid rgba(255,255,255,0.1);
		}
		.page-header h1 { 
			font-size: 2.5rem; 
			margin: 0; 
			color: #f1ecec;
			text-shadow: 0 2px 10px rgba(0,0,0,0.5);
		}

		/* Product Grid */
		.product-grid { 
			display: flex; 
			flex-wrap: wrap; 
			gap: 32px; 
			justify-content: center; 
			padding: 40px 20px; 
			max-width: 1200px; 
			margin: 0 auto;
		}

		.product-card { 
			background: var(--panel); 
			border: 2px solid var(--border); 
			border-radius: 12px; 
			width: 280px; 
			text-align: center; 
			padding: 24px 16px; 
			transition: transform 0.3s ease, border-color 0.3s ease;
		}
		.product-card:hover {
			transform: translateY(-5px);
			border-color: var(--accent);
		}
		.product-card img { 
			width: 100%; 
			height: 220px; 
			object-fit: cover; 
			border-radius: 8px; 
			background: #222; 
		}
		.product-card h3 { 
			margin: 18px 0 8px 0; 
			font-size: 1.2rem; 
			color: var(--text); 
		}
		.product-card p { 
			color: var(--muted); 
			margin: 0 0 16px 0; 
			font-size: 1.1rem;
			font-weight: 600;
		}
		.add-to-cart {
			background: var(--accent);
			color: var(--bg);
			border: none;
			padding: 10px 20px;
			border-radius: 6px;
			cursor: pointer;
			font-weight: 600;
			transition: all 0.3s ease;
		}
		.add-to-cart:hover {
			background: rgba(255,255,255,0.9);
			transform: translateY(-2px);
		}
		
		/* Loading and error states */
		.loading, .error, .empty {
			text-align: center;
			padding: 40px 20px;
			width: 100%;
		}
		
		.spinner {
			border: 4px solid rgba(255, 255, 255, 0.3);
			border-radius: 50%;
			border-top: 4px solid #fff;
			width: 40px;
			height: 40px;
			animation: spin 1s linear infinite;
			margin: 0 auto 20px;
		}
		
		@keyframes spin {
			0% { transform: rotate(0deg); }
			100% { transform: rotate(360deg); }
		}
		
		.retry-btn {
			background: var(--accent);
			color: var(--bg);
			border: none;
			padding: 10px 20px;
			border-radius: 6px;
			cursor: pointer;
			font-weight: 600;
			transition: all 0.3s ease;
			margin-top: 15px;
		}
		
		.retry-btn:hover {
			background: rgba(255,255,255,0.9);
			transform: translateY(-2px);
		}
		
		.back-btn {
			position: fixed;
			top: 20px;
			left: 20px;
			background: var(--panel);
			color: var(--text);
			border: 2px solid var(--border);
			padding: 10px 15px;
			border-radius: 8px;
			text-decoration: none;
			font-weight: 600;
			transition: all 0.3s ease;
		}
		.back-btn:hover {
			border-color: var(--accent);
			color: var(--accent);
		}
		
		/* Mobile responsive layout - match index.html */
		@media (max-width: 799px) {
			body {
				overflow-x: hidden;
				width: 100vw;
			}
			
			.container {
				max-width: 100vw;
				padding: 0 8px;
				box-sizing: border-box;
			}
			
			.product-grid {
				display: grid !important;
				grid-template-columns: repeat(2, 1fr) !important;
				gap: 8px !important;
				padding: 0 8px;
				max-width: 100%;
				box-sizing: border-box;
			}
			
			.product-card {
				width: 100% !important;
				padding: 12px 6px !important;
				box-sizing: border-box;
				min-width: 0;
			}
			
			.product-card img {
				height: 180px !important;
				width: 100%;
				object-fit: cover;
			}
			
			.product-card h3 {
				font-size: 0.95rem !important;
				margin: 8px 0 4px 0 !important;
				word-wrap: break-word;
			}
			
			.product-card p {
				font-size: 0.85rem !important;
				margin: 0 0 8px 0 !important;
				word-wrap: break-word;
			}
			
			.add-to-cart {
				padding: 6px 12px !important;
				font-size: 0.8rem !important;
				width: 100%;
				box-sizing: border-box;
			}
		}
		
		@media (max-width: 480px) {
			.product-grid {
				gap: 6px !important;
				padding: 0 4px;
			}
			
			.product-card {
				padding: 8px 4px !important;
			}
			
			.product-card img {
				height: 150px !important;
			}
			
			.product-card h3 {
				font-size: 0.85rem !important;
				margin: 6px 0 3px 0 !important;
			}
			
			.product-card p {
				font-size: 0.75rem !important;
				margin: 0 0 6px 0 !important;
			}
			
			.add-to-cart {
				padding: 5px 8px !important;
				font-size: 0.75rem !important;
			}
		}
	</style>
</head>
<body>
	<header id="header">
		<div class="logo-container">
			<a href="index.html"><img src="img/logo1.png" alt="RAW FADE Logo"></a>
		</div>
		<nav>
			<ul id="navbar">
				<li><a href="shirts.html" class="active">SHIRTS</a></li>
				<li><a href="tshirts.html">T-SHIRTS</a></li>
				<li><a href="jeans.html">JEANS</a></li>
				<li><a href="shorts.html" >SHORTS</a></li>
				<li><a href="jackets.html">JACKETS</a></li>
				<!-- Profile icon button -->
				<li>
					<a href="account.html" class="profile-icon">
						<img src="img/pngwing.com (15).png" alt="Profile">
					</a>
				</li>
			</ul>
		</nav>
	</header>
	
	<div class="page-header">
		<h1>SHIRTS</h1>
	</div>
	<div class="container">
		<div class="product-grid" id="productGrid">
			<!-- Products will be loaded dynamically here -->
			<div class="loading">
				<div class="spinner"></div>
				<p>Loading products...</p>
			</div>
		</div>
	</div>

	<script>
		// Function to load products from API
		async function loadProducts() {
			const productGrid = document.getElementById('productGrid');
			
			try {
				// Show loading indicator
				productGrid.innerHTML = `
					<div class="loading">
						<div class="spinner"></div>
						<p>Loading products...</p>
					</div>
				`;
				
				// Try to fetch products from the API
				const response = await fetch('/api/products');
				
				if (!response.ok) {
					throw new Error(`Failed to load products: ${response.status} ${response.statusText}`);
				}
				
				const allProducts = await response.json();
				
				// Filter products by category (Shirts)
				// Since there's no explicit category field, we'll filter by title/description containing "shirt"
				const shirtProducts = allProducts.filter(product => 
					(product.title && product.title.toLowerCase().includes('shirt')) ||
					(product.description && product.description.toLowerCase().includes('shirt'))
				);
				
				renderProducts(shirtProducts);
			} catch (error) {
				console.error('Error loading products:', error);
				productGrid.innerHTML = `
					<div class="error">
						<p>Error loading products: ${error.message}</p>
						<button class="retry-btn" onclick="loadProducts()">Retry</button>
					</div>
				`;
			}
		}
		
		// Function to render products in the grid
		function renderProducts(products) {
			const productGrid = document.getElementById('productGrid');
			
			if (products.length === 0) {
				productGrid.innerHTML = `
					<div class="empty">
						<p>No products found in this category.</p>
						<button class="retry-btn" onclick="loadProducts()">Refresh</button>
					</div>
				`;
				return;
			}
			
			let html = '';
			products.forEach(product => {
				const productId = product.id || Math.floor(Math.random() * 10000);
				const title = product.title || 'Product';
				// Handle image path - use fallback if not provided or invalid
				let imagePath = product.imagePath || 'img/products/d1-1.png';
				
				// Fix image path if it starts with a slash
				if (imagePath.startsWith('/')) {
					imagePath = imagePath.substring(1);
				}
				
				const price = product.price || 0;
				
				html += `
					<div class="product-card" data-product-id="${productId}">
						<img src="${imagePath}" alt="${title}" 
						     onerror="this.src='img/products/d1-1.png'">
						<h3>${title}</h3>
						<p>â‚¹ ${parseInt(price).toLocaleString()}</p>
						<button class="add-to-cart" onclick="addToCart(${productId}, '${title}', ${price}, '${imagePath}')">
							Add to Cart
						</button>
					</div>
				`;
			});
			
			productGrid.innerHTML = html;
		}
		
		// Add to cart function
		async function addToCart(productId, productName, price, image) {
			const token = localStorage.getItem('token');
			const username = localStorage.getItem('username');
			
			if (!token || !username) {
				alert('Please login to add items to cart');
				window.location.href = 'login.html';
				return;
			}

			try {
				// Try backend API first
				const response = await fetch(`/api/cart/user/${username}/add?productId=${productId}&quantity=1`, {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json',
						'Authorization': `Bearer ${token}`
					}
				});

				if (response.ok) {
					alert('Product added to cart successfully!');
					return;
				}
			} catch (error) {
				console.log('Backend API not available, using localStorage fallback');
			}

			// Fallback to localStorage
			const cartKey = `cart_${username}`;
			let cart = JSON.parse(localStorage.getItem(cartKey)) || [];
			
			const existingItem = cart.find(item => item.id === productId);
			if (existingItem) {
				existingItem.quantity += 1;
			} else {
				cart.push({
					id: productId,
					name: productName,
					price: parseFloat(price),
					image: image,
					quantity: 1,
					addedAt: new Date().toISOString()
				});
			}
			
			localStorage.setItem(cartKey, JSON.stringify(cart));
			alert('Product added to cart successfully!');
		}
		
		// Load products when page loads
		document.addEventListener('DOMContentLoaded', function() {
			loadProducts();
		});
	</script>
</body>
</html>